<?xml version="1.0" encoding="UTF-8"?>
<odoo>
<data>
    <template id="nomin_partner_register" name="Харилцагч бүртгэл">
        <t t-call="website.layout" >
            <div id="wrap" class="oe_structure oe_empty">
                <div class="container">
                  <div class="content-bg" style="background:0">
                      <div class="col-sm-9 col-md-9">
                          <h3 class="pagetitle">Бүртгүүлэх хүсэлт</h3>
                          <form action="/web/partner/register_request" method="post" data-success_page="/page/nomin_web.thanks"  class="s_website_form form-horizontal container-fluid" enctype="multipart/form-data" >
                              <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                 

                              <div class="form-group form-field o_website_form_required_custom">
                                  <label class="col-md-3 col-sm-4 control-label" for="partner_type">Харилцагчийн төрөл</label>
                                  <div class="col-md-7 col-sm-8">
                                      
                                      <select  onchange="onFocusPartnerType()" id="partner_type" name="partner_type" class="form-control input-sm" t-att-value="partner_type or ''">
                                          <option value="">.:Сонгох:.</option>
                                          <option value="tender"   t-att-selected="partner_type == 'tender'">Тендерт оролцох харилцагч</option>
                                          <option value="insurance_broker" t-att-selected="partner_type == 'insurance_broker'">Даатгалын зуучлагч</option>
                                      </select>
                                  
                                      
                                  </div>
                              </div>

                              <div class="form-group form-field o_website_form_required_custom">
                                  <label class="col-md-3 col-sm-4 control-label" for="register_number">Регистрийн дугаар</label>
                                  <div class="col-md-7 col-sm-8">
                                      
                                          <input name="register_number" type="text" onfocusout="myFunction()" required="1" class="form-control o_website_form_input" placeholder="Регистрийн дугаар" id="register_number" t-att-value="request.params.get('register_number', '')"/>
                                  
                                      
                                  </div>
                              </div>
                              <t  >
                                  <div  id="parent_register_number" style="display: none"  class="form-group form-field">
                                      <label class="col-md-3 col-sm-4 control-label" for="parent_register_number">Харъяалагдах компаний РД</label>
                                      <div class="col-md-7 col-sm-8">
                                          
                                              <input id="is_required" name="parent_register_number" type="text"  required="1" class="form-control o_website_form_input" placeholder="Регистрийн дугаар"  t-att-value="request.params.get('parent_register_number', '')"/>
                                      
                                          
                                      </div>
                                  </div>
                              </t>

                                 <div class="form-group form-field o_website_form_required_custom">
                                  <label class="col-md-3 col-sm-4 control-label" for="company_name">Нэр</label>
                                  <div class="col-md-7 col-sm-8">
                                  <input type="text" required="1" class="form-control o_website_form_input" placeholder="Нэр" id="company_name" name="company_name" t-att-value="request.params.get('company_name', '')"/>
                                  
                                  
                                  </div>
                              </div>
                               <div class="form-group form-field o_website_form_required_custom">
                                  <label class="col-md-3 col-sm-4 control-label" for="company_name">Хаяг</label>
                                  <div class="col-md-7 col-sm-8">
                                      <input type="text" class="form-control o_website_form_input" placeholder="Хаяг" id="street" name="street" required="1" t-att-value="request.params.get('street', '')" />
                                  

                                  </div>
                              </div>
                              
                              <div class="form-group form-field o_website_form_required_custom">
                                  <label class="col-md-3 col-sm-4 control-label" for="phonenumber">Утас </label>
                                  <div class="col-md-7 col-sm-8">
                                      
                                          <input name="phone" type="text" class="form-control o_website_form_input" placeholder="Утасны дугаар" id="phone" required="1" t-att-value="request.params.get('phone', '')"/>
                                      

                                  </div>
                              </div>
                              
                              
                              <div class="form-group form-field o_website_form_required_custom">
                                  <label class="col-md-3 col-sm-4 control-label" for="email">Цахим шуудан</label>
                                  <div class="col-md-7 col-sm-8">
                                      
                                          <input name="email" required="1" type="text" onchange="ValidateEmail()" class="form-control" placeholder="И-Мэйл хаяг"  id="email" t-att-value="request.params.get('email', '')"/>

                                      
                                  </div>
                              </div>

                              <div id="website"   class="form-group form-field o_website_form_required_custom">
                                  <label class="col-md-3 col-sm-4 control-label" for="website">Вэбсайт</label>
                                  <div class="col-md-7 col-sm-8">
                          
                                          <input  name="website" type="text" class="form-control" placeholder="Вэбсайт" id="website" t-att-value="request.params.get('website', '')"/>
                                  
                                  </div>
                              </div>
                              
                              <div id="area_activity"  class="form-group form-field ">
                                  <label class="col-md-3 col-sm-4 control-label" for="area_activity">Үйл ажиллагааны чиглэл <b style="color:red">*</b></label>
                                        <div  class="col-md-7 col-sm-8">										                 
                                         <select name="area_activity"  multiple="multiple" id="e1" class="form-control input-sm" t-att-value="area_activity">
                                              <t t-foreach="activities.sorted(key=lambda x: (x.name)) or []" t-as="area_activity">															
                                                  <option t-att-value="area_activity.id">
                                                      <t t-esc="area_activity.name"/>
                                                  </option>
                                              </t>
                                          </select>
                                      </div>
                              </div>

                              <div class="form-group form-field o_website_form_required_custom">
                                  <label class="col-md-3 col-sm-4 control-label" for="email">Тайлбар</label>
                                  <div class="col-md-7 col-sm-8">
                                      <t>
                                          <textarea required="1" id="description" name="description" rows="5" class="form-control o_website_form_input" placeholder="Тайлбар бичих ..."/>
                                      </t>
                                      
                                  </div>
                              </div>
                              <div class="form-group" style="text-align:center">
                                  <div class="col-md-offset-3 col-sm-offset-4 col-sm-8 col-md-7">
                                  <!-- 	<button class="btn btn-primary" type="submit" >Илгээх</button>
                                      <a t-attf-href="/web/login" class="btn btn-default" type="button">Буцах</a> -->
                                      <button class="btn btn-primary btn-md" >Бүртгүүлэх хүсэлт</button>
                                          
                                      <a t-attf-href="/new_tenders/" class="btn btn-primary btn-md" type="button">Буцах</a>
                                  </div>
                              </div>
                          </form>
              </div>

                </div>
                </div>
           </div>
      </t>
      
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/3.2/select2.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/3.2/select2.min.js"></script>
        <script type="text/javascript">


                    <![CDATA[
                    $("#button").click(function(){
        alert($("#e1").val());
    });
                    $( document ).ready(function() { 
    console.log( "ready!" );
    $("#e1").select2();
    });

    function ValidateEmail()
            {
                console.log('working')
                    var inputText = document.getElementById("email");
                var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
            if(inputText.value.match(mailformat))
                {					
                    return true;
                }
                else
                {
                    
                    alert("Зөв мэйл хаяг оруулна уу.!");
                    
                    return false;
                }
            }
    function onFocusPartnerType() {
            var partner_type = document.getElementById("partner_type").value;
            if (partner_type == "insurance_broker") {
                $("#parent_register_number").show();
                $("#area_activity").hide();
                $("#website").hide();
                $('#area_activity').removeAttr('required'); ;
            } else {
                $("#parent_register_number").hide();
                $("#website").show();
                $("#area_activity").show();
                $('#is_required').removeAttr('required'); ;
            }
        }
                function myFunction() {
    var tax_number = document.getElementById("register_number").value;
    
    var company_name = document.getElementById("company_name");

    
    $.ajax({ 
            type: 'GET', 
            
            url: '/web/register/checkpartner', 
            data: { tax_number: tax_number}, 
            success: function (data) {             	
                company_name.value = data;
            }	
            });
    }
    ]]>
                </script>
    </template>
</data>    
</odoo>